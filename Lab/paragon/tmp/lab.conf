#include "/vmm/bin/common.defs"
#include "/vmm/data/user_disks/vmxc/common.vmx.p3.defs"
#include "/vmm/data/user_disks/vptxc/common.evovptx.ardbeg.defs"
#include "/vmm/data/user_disks/vptxc/common.ardbeg.defs"
#undef GW_DISK
#define GW_DISK basedisk "/vmm/data/user_disks/irzan/images/gw.qcow2";
#undef DESKTOP_DISK
#define DESKTOP_DISK basedisk "/vmm/data/user_disks/irzan/images/desktop.qcow2";
#undef UBUNTU_DISK
#define UBUNTU_DISK basedisk "/vmm/data/user_disks/irzan/images/ubuntu-20.04.qcow2";
#undef VMX_DISK0
#define VMX_DISK0  basedisk "/vmm/data/user_disks/irzan/images/vmx/junos-vmx-x86-64-21.4R1.12.vmdk";
#undef BRIDGE_DISK
#define BRIDGE_DISK basedisk "/vmm/data/user_disks/irzan/images/bridge.qcow2";
config "pa"{
  bridge "mgmt"{};
  bridge "control"{};
  bridge "desktop"{};
  bridge "r1ge0"{};
  bridge "ptp0"{};
  bridge "ptp1"{};
  bridge "r2ge0"{};
  bridge "br1em13"{};
  bridge "br1em5"{};
  bridge "br1em1"{};
  bridge "br1em3"{};
  bridge "r3ge0"{};
  bridge "br1em14"{};
  bridge "br1em9"{};
  bridge "r4ge0"{};
  bridge "br1em6"{};
  bridge "br1em10"{};
  bridge "br1em11"{};
  bridge "br1em7"{};
  bridge "r5ge0"{};
  bridge "br1em12"{};
  bridge "br1em15"{};
  bridge "ptp10"{};
  bridge "ptp11"{};
  bridge "r6ge0"{};
  bridge "br1em2"{};
  bridge "br1em4"{};
  bridge "br1em8"{};
  bridge "br1em16"{};
  bridge "ptp12"{};
  bridge "r7ge0"{};
  bridge "ptp13"{};
  bridge "r8ge0"{};
  bridge "reserved_bridge"{};
  PRIVATE_BRIDGES
vm "gw" {
   hostname "gw";
    GW_DISK
   setvar "+qemu_args" "-cpu qemu64,+vmx";
   ncpus 2;
   memory 4096;
   interface "em0" { bridge "external";};
   interface "em1" { bridge "mgmt";};
   interface "em2" { bridge "control";};
   interface "em3" { bridge "desktop";};
};
vm "desktop" {
   hostname "desktop";
    DESKTOP_DISK
   setvar "+qemu_args" "-cpu qemu64,+vmx";
   ncpus 2;
   memory 16384;
   setvar "enable_vnc" "1";
   interface "em0" { bridge "desktop";};
   install "/vmm/data/user_disks/irzan/vm/pa/lab.conf" "/lab.conf";
};
vm "control" {
   hostname "control";
    UBUNTU_DISK
   setvar "+qemu_args" "-cpu host,+vmx";
   ncpus 4;
   memory 16384;
   setvar "enable_vnc" "1";
   interface "em0" { bridge "control";};
   install "/vmm/data/user_disks/irzan/vm/pa/lab.conf" "/lab.conf";
};
vm "node0" {
   hostname "node0";
    UBUNTU_DISK
   setvar "+qemu_args" "-cpu host,+vmx";
   ncpus 8;
   memory 32768;
   interface "em0" { bridge "control";};
   install "/vmm/data/user_disks/irzan/vm/pa/lab.conf" "/lab.conf";
};
vm "node1" {
   hostname "node1";
    UBUNTU_DISK
   setvar "+qemu_args" "-cpu host,+vmx";
   ncpus 8;
   memory 32768;
   interface "em0" { bridge "control";};
   install "/vmm/data/user_disks/irzan/vm/pa/lab.conf" "/lab.conf";
};
vm "node2" {
   hostname "node2";
    UBUNTU_DISK
   setvar "+qemu_args" "-cpu host,+vmx";
   ncpus 8;
   memory 32768;
   interface "em0" { bridge "control";};
   install "/vmm/data/user_disks/irzan/vm/pa/lab.conf" "/lab.conf";
};
vm "node3" {
   hostname "node3";
    UBUNTU_DISK
   setvar "+qemu_args" "-cpu host,+vmx";
   ncpus 8;
   memory 32768;
   interface "em0" { bridge "control";};
   install "/vmm/data/user_disks/irzan/vm/pa/lab.conf" "/lab.conf";
};
   
   #undef EM_IPADDR
   #define EM_IPADDR interface "em0" { bridge "mgmt";};
   #define VMX_CHASSIS_I2CID 48
   #define VMX_CHASSIS_NAME r1
   VMX_CHASSIS_START() 
      VMX_RE_START(r1_re,0)
         VMX_RE_INSTANCE(r1_re0, VMX_DISK0, VMX_RE_I2CID,0)
         install "/vmm/data/user_disks/irzan/vm/pa/r1.conf" "/root/junos.base.conf";
      VMX_RE_END
      VMX_MPC_START(r1_MP,0)
        VMX_MPC_INSTANCE(r1_MPC, VMX_DISK0, VMX_MPC_I2CID, 0)
            VMX_CONNECT(GE(0,0,0), r1ge0)
            VMX_CONNECT(GE(0,0,1), ptp0)
            VMX_CONNECT(GE(0,0,2), ptp1)
      VMX_MPC_END
   VMX_CHASSIS_END
   #undef VMX_CHASSIS_I2CID
   #undef VMX_CHASSIS_NAME
   
   #undef EM_IPADDR
   #define EM_IPADDR interface "em0" { bridge "mgmt";};
   #define VMX_CHASSIS_I2CID 48
   #define VMX_CHASSIS_NAME r2
   VMX_CHASSIS_START() 
      VMX_RE_START(r2_re,0)
         VMX_RE_INSTANCE(r2_re0, VMX_DISK0, VMX_RE_I2CID,0)
         install "/vmm/data/user_disks/irzan/vm/pa/r2.conf" "/root/junos.base.conf";
      VMX_RE_END
      VMX_MPC_START(r2_MP,0)
        VMX_MPC_INSTANCE(r2_MPC, VMX_DISK0, VMX_MPC_I2CID, 0)
            VMX_CONNECT(GE(0,0,0), r2ge0)
            VMX_CONNECT(GE(0,0,1), ptp0)
            VMX_CONNECT(GE(0,0,2), br1em13)
            VMX_CONNECT(GE(0,0,3), br1em5)
            VMX_CONNECT(GE(0,0,4), br1em1)
            VMX_CONNECT(GE(0,0,5), br1em3)
      VMX_MPC_END
   VMX_CHASSIS_END
   #undef VMX_CHASSIS_I2CID
   #undef VMX_CHASSIS_NAME
   
   #undef EM_IPADDR
   #define EM_IPADDR interface "em0" { bridge "mgmt";};
   #define VMX_CHASSIS_I2CID 48
   #define VMX_CHASSIS_NAME r3
   VMX_CHASSIS_START() 
      VMX_RE_START(r3_re,0)
         VMX_RE_INSTANCE(r3_re0, VMX_DISK0, VMX_RE_I2CID,0)
         install "/vmm/data/user_disks/irzan/vm/pa/r3.conf" "/root/junos.base.conf";
      VMX_RE_END
      VMX_MPC_START(r3_MP,0)
        VMX_MPC_INSTANCE(r3_MPC, VMX_DISK0, VMX_MPC_I2CID, 0)
            VMX_CONNECT(GE(0,0,0), r3ge0)
            VMX_CONNECT(GE(0,0,1), ptp1)
            VMX_CONNECT(GE(0,0,2), br1em14)
            VMX_CONNECT(GE(0,0,3), br1em9)
      VMX_MPC_END
   VMX_CHASSIS_END
   #undef VMX_CHASSIS_I2CID
   #undef VMX_CHASSIS_NAME
   
   #undef EM_IPADDR
   #define EM_IPADDR interface "em0" { bridge "mgmt";};
   #define VMX_CHASSIS_I2CID 48
   #define VMX_CHASSIS_NAME r4
   VMX_CHASSIS_START() 
      VMX_RE_START(r4_re,0)
         VMX_RE_INSTANCE(r4_re0, VMX_DISK0, VMX_RE_I2CID,0)
         install "/vmm/data/user_disks/irzan/vm/pa/r4.conf" "/root/junos.base.conf";
      VMX_RE_END
      VMX_MPC_START(r4_MP,0)
        VMX_MPC_INSTANCE(r4_MPC, VMX_DISK0, VMX_MPC_I2CID, 0)
            VMX_CONNECT(GE(0,0,0), r4ge0)
            VMX_CONNECT(GE(0,0,1), br1em6)
            VMX_CONNECT(GE(0,0,2), br1em10)
            VMX_CONNECT(GE(0,0,3), br1em11)
            VMX_CONNECT(GE(0,0,4), br1em7)
            VMX_CONNECT(GE(0,0,5), control)
      VMX_MPC_END
   VMX_CHASSIS_END
   #undef VMX_CHASSIS_I2CID
   #undef VMX_CHASSIS_NAME
   
   #undef EM_IPADDR
   #define EM_IPADDR interface "em0" { bridge "mgmt";};
   #define VMX_CHASSIS_I2CID 48
   #define VMX_CHASSIS_NAME r5
   VMX_CHASSIS_START() 
      VMX_RE_START(r5_re,0)
         VMX_RE_INSTANCE(r5_re0, VMX_DISK0, VMX_RE_I2CID,0)
         install "/vmm/data/user_disks/irzan/vm/pa/r5.conf" "/root/junos.base.conf";
      VMX_RE_END
      VMX_MPC_START(r5_MP,0)
        VMX_MPC_INSTANCE(r5_MPC, VMX_DISK0, VMX_MPC_I2CID, 0)
            VMX_CONNECT(GE(0,0,0), r5ge0)
            VMX_CONNECT(GE(0,0,1), br1em12)
            VMX_CONNECT(GE(0,0,2), br1em15)
            VMX_CONNECT(GE(0,0,3), ptp10)
            VMX_CONNECT(GE(0,0,4), ptp11)
      VMX_MPC_END
   VMX_CHASSIS_END
   #undef VMX_CHASSIS_I2CID
   #undef VMX_CHASSIS_NAME
   
   #undef EM_IPADDR
   #define EM_IPADDR interface "em0" { bridge "mgmt";};
   #define VMX_CHASSIS_I2CID 48
   #define VMX_CHASSIS_NAME r6
   VMX_CHASSIS_START() 
      VMX_RE_START(r6_re,0)
         VMX_RE_INSTANCE(r6_re0, VMX_DISK0, VMX_RE_I2CID,0)
         install "/vmm/data/user_disks/irzan/vm/pa/r6.conf" "/root/junos.base.conf";
      VMX_RE_END
      VMX_MPC_START(r6_MP,0)
        VMX_MPC_INSTANCE(r6_MPC, VMX_DISK0, VMX_MPC_I2CID, 0)
            VMX_CONNECT(GE(0,0,0), r6ge0)
            VMX_CONNECT(GE(0,0,1), br1em2)
            VMX_CONNECT(GE(0,0,2), br1em4)
            VMX_CONNECT(GE(0,0,3), br1em8)
            VMX_CONNECT(GE(0,0,4), br1em16)
            VMX_CONNECT(GE(0,0,5), ptp12)
      VMX_MPC_END
   VMX_CHASSIS_END
   #undef VMX_CHASSIS_I2CID
   #undef VMX_CHASSIS_NAME
   
   #undef EM_IPADDR
   #define EM_IPADDR interface "em0" { bridge "mgmt";};
   #define VMX_CHASSIS_I2CID 48
   #define VMX_CHASSIS_NAME r7
   VMX_CHASSIS_START() 
      VMX_RE_START(r7_re,0)
         VMX_RE_INSTANCE(r7_re0, VMX_DISK0, VMX_RE_I2CID,0)
         install "/vmm/data/user_disks/irzan/vm/pa/r7.conf" "/root/junos.base.conf";
      VMX_RE_END
      VMX_MPC_START(r7_MP,0)
        VMX_MPC_INSTANCE(r7_MPC, VMX_DISK0, VMX_MPC_I2CID, 0)
            VMX_CONNECT(GE(0,0,0), r7ge0)
            VMX_CONNECT(GE(0,0,1), ptp10)
            VMX_CONNECT(GE(0,0,2), ptp12)
            VMX_CONNECT(GE(0,0,3), ptp13)
      VMX_MPC_END
   VMX_CHASSIS_END
   #undef VMX_CHASSIS_I2CID
   #undef VMX_CHASSIS_NAME
   
   #undef EM_IPADDR
   #define EM_IPADDR interface "em0" { bridge "mgmt";};
   #define VMX_CHASSIS_I2CID 48
   #define VMX_CHASSIS_NAME r8
   VMX_CHASSIS_START() 
      VMX_RE_START(r8_re,0)
         VMX_RE_INSTANCE(r8_re0, VMX_DISK0, VMX_RE_I2CID,0)
         install "/vmm/data/user_disks/irzan/vm/pa/r8.conf" "/root/junos.base.conf";
      VMX_RE_END
      VMX_MPC_START(r8_MP,0)
        VMX_MPC_INSTANCE(r8_MPC, VMX_DISK0, VMX_MPC_I2CID, 0)
            VMX_CONNECT(GE(0,0,0), r8ge0)
            VMX_CONNECT(GE(0,0,1), ptp11)
            VMX_CONNECT(GE(0,0,2), ptp13)
      VMX_MPC_END
   VMX_CHASSIS_END
   #undef VMX_CHASSIS_I2CID
   #undef VMX_CHASSIS_NAME
vm "c1" {
   hostname "c1";
    UBUNTU_DISK
   setvar "+qemu_args" "-cpu qemu64,+vmx";
   ncpus 1;
   memory 4096;
   interface "em0" { bridge "mgmt";};
   interface "em1" { bridge "r1ge0";};
   interface "em2" { bridge "r2ge0";};
   interface "em3" { bridge "r3ge0";};
   interface "em4" { bridge "r4ge0";};
   interface "em5" { bridge "r5ge0";};
   interface "em6" { bridge "r6ge0";};
   interface "em7" { bridge "r7ge0";};
   interface "em8" { bridge "r8ge0";};
   install "/vmm/data/user_disks/irzan/vm/pa/lab.conf" "/lab.conf";
};
vm "br1" {
   hostname "br1";
    BRIDGE_DISK
   setvar "+qemu_args" "-cpu qemu64,+vmx";
   ncpus 2;
   memory 2048;
   interface "em0" { bridge "mgmt";};
   interface "em1" { bridge "br1em1";};
   interface "em2" { bridge "br1em2";};
   interface "em3" { bridge "br1em3";};
   interface "em4" { bridge "br1em4";};
   interface "em5" { bridge "br1em5";};
   interface "em6" { bridge "br1em6";};
   interface "em7" { bridge "br1em7";};
   interface "em8" { bridge "br1em8";};
   interface "em9" { bridge "br1em9";};
   interface "em10" { bridge "br1em10";};
   interface "em11" { bridge "br1em11";};
   interface "em12" { bridge "br1em12";};
   interface "em13" { bridge "br1em13";};
   interface "em14" { bridge "br1em14";};
   interface "em15" { bridge "br1em15";};
   interface "em16" { bridge "br1em16";};
   install "/vmm/data/user_disks/irzan/vm/pa/lab.conf" "/lab.conf";
};
};
